<div class="overview-service">
  <div class="service-heading">
    <div ng-if="route = routes[0]">
      <small class="text-muted text-uppercase">
        Service:
        <a ng-href="{{service | navigateResourceURL}}" class="subtle-link">{{service.metadata.name}}</a>
      </small>
      <h2 class="service-title">
        <a ng-if="route | isWebRoute"
           ng-href="{{route | routeWebURL}}">{{route | routeLabel}}</a>
        <span ng-if="!(route | isWebRoute)">{{route | routeLabel}}</span>
      </h2>
    </div>
    <div ng-if="!route">
      <small class="text-muted text-uppercase">Service</small>
      <h2 class="service-title">
        <a ng-href="{{service | navigateResourceURL}}">{{service.metadata.name}}</a>
      </h2>
    </div>
  </div>
  <div class="service-body">
    <div ng-repeat="dc in deploymentConfigs">
      <div row mobile="column" ng-repeat="pipeline in runningPipelines[dc.metadata.name] | orderObjectsByDate : true track by (pipeline | uid)">
        <div column grow="4">
          <build-pipeline flex build="pipeline"></build-pipeline>
        </div>
      </div>
    </div>
    <div ng-if="!(deployments | hashSize)" class="mar-md">
      There are no deployments for this service.
    </div>
    <!-- FIXME: ng-if is not exactly right, need to understand how to show dep status -->
    <div ng-repeat="deployment in deployments | orderObjectsByDate : true track by (deployment | uid)"
         ng-if="deployment.status.replicas">

      <div row tablet="column">
        <div column
             tablet="row"
             ng-if="pipelinesByDeployment[deployment.metadata.name]"
             ng-attr-grow="{{(pipelinesByDeployment[deployment.metadata.name] | isIncompleteBuild) ? 3 : undefined}}">
          <build-pipeline
              flex
              build="pipelinesByDeployment[deployment.metadata.name]"
              collapse-stages="!(pipelinesByDeployment[deployment.metadata.name] | isIncompleteBuild)">
          </build-pipeline>
        </div>

        <div column mobile="row" grow="1">
          <div row mobile="column" class="deployment-block">
            <div
                 column
                 grow="3"
                 ng-if="!(pipelinesByDeployment[deployment.metadata.name] | isIncompleteBuild)"
                 class="deployment-details">
              <deployment-pipeline-details
                  ng-if="!(pipelinesByDeployment[deployment.metadata.name] | isIncompleteBuild)"
                  flex
                  deployment="deployment">
              </deployment-pipeline-details>
            </div>
            <div column class="deployment-donut">
              <pod-status-chart pods="podsByDeployment[deployment.metadata.name]"></pod-status-chart>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
