<project-header class="top-header"></project-header>
<project-page class="overview-new">
  <div class="middle-section">
    <div class="middle-container">
      <div class="container-fluid page-notifications">
        <tasks></tasks>
        <alerts alerts="overview.state.alerts"></alerts>
      </div>
      <!-- Empty states -->
      <div ng-if="overview.renderOptions.showGetStarted">
        <!-- Getting started -->
        <div class="empty-project text-center">
          <div ng-if="project.metadata.name | canIAddToProject">
            <h2>Get started with your project.</h2>
            <p class="gutter-top">
              Use your source or an example repository to build an application
              image, or add components like databases and message queues.
            </p>
            <p class="gutter-top">
              <a ng-href="project/{{projectName}}/create" class="btn btn-lg btn-primary">
                Add to Project
              </a>
            </p>
          </div>
          <div ng-if="!(project.metadata.name | canIAddToProject)">
            <h2>Welcome to project {{projectName}}.</h2>
            <ng-include src="'views/_request-access.html'"></ng-include>
          </div>
        </div>
      </div>
      <div ng-if="overview.renderOptions.showLoading" class="container-fluid loading-message">
        Loading...
      </div>
      <div ng-if="!overview.renderOptions.showGetStarted && !overview.renderOptions.showLoading">
        <div class="middle-header header-toolbar">
          <div class="container-fluid">
            <div class="page-header page-header-bleed-right page-header-bleed-left">
              <h1>
                Project {{projectName}}
              </h1>
            </div>
            <div class="data-toolbar">
              <div class="data-toolbar-filter">
                <ui-select class="data-toolbar-dropdown" ng-model="overview.filterBy" search-enabled="false" append-to-body="true">
                  <ui-select-match>{{$select.selected.label}}</ui-select-match>
                  <ui-select-choices repeat="option.id as option in overview.filterByOptions">
                    {{option.label}}
                  </ui-select-choices>
                </ui-select>
                <div ng-if="overview.filterBy === 'label'" class="label-filter">
                  <project-filter></project-filter>
                </div>
                <div ng-if="overview.filterBy === 'name'" class="name-filter">
                  <form role="form" class="search-pf has-button">
                    <div class="form-group filter-controls has-clear">
                      <div class="search-pf-input-group">
                        <label for="name-filter" class="sr-only">Filter by name</label>
                        <input
                            type="text"
                            ng-model="overview.filterText"
                            placeholder="Filter by name"
                            autocorrect="off"
                            autocapitalize="off"
                            spellcheck="false">
                        <button
                            type="button"
                            class="clear"
                            aria-hidden="true"
                            ng-if="overview.filterText"
                            ng-click="overview.filterText = ''">
                            <span class="pficon pficon-close"></span>
                        </button>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
              <div class="vertical-divider"></div>
              <div class="view-by-options">
                <span class="data-toolbar-label">View by</span>
                <ui-select class="data-toolbar-dropdown" ng-model="overview.viewBy" search-enabled="false">
                  <ui-select-match>{{$select.selected.label}}</ui-select-match>
                  <ui-select-choices repeat="option.id as option in overview.viewByOptions">
                    {{option.label}}
                  </ui-select-choices>
                </ui-select>
              </div>
            </div>
          </div>
        </div>
        <div class="middle-content">
          <div class="container-fluid">
            <div ng-if="overview.filterActive">
              Showing <strong>{{overview.filteredSize}}</strong> of <strong>{{overview.size}}</strong> items
            </div>
            <div ng-if="overview.everythingFiltered">
              <div class="empty-state-message text-center h2">
                The filter is hiding all resources.
                <a href="" ng-click="overview.clearFilter()">Clear Filter</a>
              </div>
            </div>
            <div ng-if="!overview.everythingFiltered" class="row">
              <div ng-if="overview.viewBy === 'app'" ng-repeat="app in overview.apps" class="col-md-12" ng-class="{ 'mar-top-lg': !app }">
                <h2 ng-if="app">
                  <div class="component-label">Application</div>
                  <span ng-bind-html="app | highlightKeywords : overview.state.filterKeywords"></span>
                </h2>
                <div class="list-view-pf" ng-class="{ 'mar-top-xl': !app }">
                  <overview-list-row
                       ng-repeat="deploymentConfig in overview.filteredDCByApp[app] track by (deploymentConfig | uid)"
                       ng-init="dcName = deploymentConfig.metadata.name"
                       api-object="deploymentConfig"
                       current="overview.activeByDC[dcName]"
                       previous="overview.rcByDC[dcName][1]"
                       state="overview.state"
                       recent-pipelines="overview.recentPipelinesByDC[dcName]">
                  </overview-list-row>
                  <overview-list-row
                       ng-repeat="deployment in overview.filteredDeploymentsByApp[app] track by (deployment | uid)"
                       api-object="deployment"
                       current="overview.activeByDeployment[deployment.metadata.name]"
                       previous="overview.replicaSetsByDeployment[deployment.metadata.name][1]"
                       state="overview.state">
                  </overview-list-row>
                  <overview-list-row
                       ng-repeat="replicationController in overview.filteredRCByApp[app] track by (replicationController | uid)"
                       api-object="replicationController"
                       current="replicationController"
                       state="overview.state">
                  </overview-list-row>
                  <overview-list-row
                       ng-repeat="replicaSet in overview.filteredReplicaSetsByApp[app] track by (replicaSet | uid)"
                       api-object="replicaSet"
                       state="overview.state">
                  </overview-list-row>
                  <overview-list-row
                       ng-repeat="statefulSet in overview.filteredStatefulSetsByApp[app] track by (statefulSet | uid)"
                       api-object="statefulSet"
                       state="overview.state">
                  </overview-list-row>
                  <overview-list-row
                       ng-repeat="pod in overview.filteredMonopodsByApp[app] track by (pod | uid)"
                       api-object="pod"
                       state="overview.state">
                  </overview-list-row>
                </div>
              </div>
              <div ng-if="overview.viewBy === 'resource'" class="container-fluid">
                <div ng-if="overview.filteredDeploymentConfigs | hashSize">
                  <h2>
                    <span ng-if="overview.deployments | hashSize">
                      Deployment Configs
                    </span>
                    <span ng-if="!(overview.deployments | hashSize)">
                      Deployments
                    </span>
                  </h2>
                  <div class="list-view-pf">
                    <overview-list-row
                         ng-repeat="deploymentConfig in overview.filteredDeploymentConfigs track by (deploymentConfig | uid)"
                         ng-init="dcName = deploymentConfig.metadata.name"
                         api-object="deploymentConfig"
                         current="overview.activeByDC[dcName]"
                         previous="overview.rcByDC[dcName][1]"
                         state="overview.state"
                         recent-pipelines="overview.recentPipelinesByDC[dcName]">
                    </overview-list-row>
                  </div>
                </div>
                <div ng-if="overview.filteredDeployments | hashSize">
                  <h2>Deployments</h2>
                  <div class="list-view-pf">
                    <overview-list-row
                         ng-repeat="deployment in overview.filteredDeployments track by (deployment | uid)"
                         api-object="deployment"
                         current="overview.activeByDeployment[deployment.metadata.name]"
                         previous="overview.replicaSetsByDeployment[deployment.metadata.name][1]"
                         state="overview.state">
                    </overview-list-row>
                  </div>
                </div>
                <div ng-if="overview.filteredReplicationControllers | hashSize">
                  <h2>Replication Controllers</h2>
                  <div class="list-view-pf">
                    <overview-list-row
                         ng-repeat="replicationController in overview.filteredReplicationControllers track by (replicationController | uid)"
                         api-object="replicationController"
                         state="overview.state">
                    </overview-list-row>
                  </div>
                </div>
                <div ng-if="overview.filteredReplicaSets | hashSize">
                  <h2>Replica Sets</h2>
                  <div class="list-view-pf">
                    <overview-list-row
                         ng-repeat="replicaSet in overview.filteredReplicaSets track by (replicaSet | uid)"
                         api-object="replicaSet"
                         state="overview.state">
                    </overview-list-row>
                  </div>
                </div>
                <div ng-if="overview.filteredStatefulSets | hashSize">
                  <h2>Stateful Sets</h2>
                  <div class="list-view-pf">
                    <overview-list-row
                         ng-repeat="statefulSet in overview.filteredStatefulSets track by (statefulSet | uid)"
                         api-object="statefulSet"
                         state="overview.state">
                    </overview-list-row>
                  </div>
                </div>
                <div ng-if="overview.filteredMonopods | hashSize">
                  <h2>Pods</h2>
                  <div class="list-view-pf">
                    <overview-list-row
                         ng-repeat="pod in overview.filteredMonopods track by (pod | uid)"
                         api-object="pod"
                         state="overview.state">
                    </overview-list-row>
                  </div>
                </div>
              </div>
              <div ng-if="overview.viewBy === 'pipeline'" class="container-fluid">
                <!-- TODO: Reuse pipelines empty state message from pipelines.html -->
                <div ng-if="!(overview.dcByPipeline | hashSize)" class="empty-state-message text-center">
                  <h2>No pipelines.</h2>
                  <div ng-if="project.metadata.name | canIAddToProject">
                    <p>
                      No pipelines have been added to project {{projectName}}.
                      <br>
                      Learn more about
                      <a ng-href="{{ 'pipeline-builds' | helpLink}}" target="_blank">Pipeline Builds</a>
                      and the
                      <a ng-href="{{ 'pipeline-plugin' | helpLink}}" target="_blank">OpenShift Pipeline Plugin</a>.
                    </p>
                    <p ng-if="(project.metadata.name | canIAddToProject) && overview.samplePipelineURL">
                      <a ng-href="{{overview.samplePipelineURL}}" class="btn btn-lg btn-primary">
                        Create Sample Pipeline
                      </a>
                    </p>
                  </div>
                  <div ng-if="!(project.metadata.name | canIAddToProject)">
                    <ng-include src="'views/_request-access.html'"></ng-include>
                  </div>
                </div>
                <div ng-if="overview.dcByPipeline | hashSize">
                  <div ng-repeat="(pipelineName, deploymentConfigNames) in overview.dcByPipeline" class="mar-bottom-lg">
                    <h2>
                      <div class="component-label">Pipeline</div>
                      {{pipelineName}}
                    </h2>
                    <div ng-if="!(overview.recentPipelinesByBC[pipelineName] | hashSize)" class="mar-bottom-lg">
                      No pipeline runs.
                    </div>
                    <div ng-repeat="pipeline in overview.recentPipelinesByBC[pipelineName] | orderObjectsByDate : true track by (pipeline | uid)"
                         class="row build-pipeline-wrapper animate-repeat animate-slide">
                      <div class="col-sm-12">
                        <build-pipeline build="pipeline" build-config-name-on-expanded="true"></build-pipeline>
                      </div>
                    </div>
                    <div ng-if="deploymentConfigNames.length" class="list-view-pf">
                      <overview-list-row
                           ng-repeat="dcName in deploymentConfigNames"
                           api-object="overview.deploymentConfigs[dcName]"
                           current="overview.activeByDC[dcName]"
                           previous="overview.rcByDC[dcName][1]"
                           state="overview.state">
                      </overview-list-row>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</project-page>
